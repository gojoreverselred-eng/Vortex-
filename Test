local Library = {}
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local HttpService = game:GetService("HttpService")

local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled
local screenGui = Instance.new("ScreenGui")
screenGui.Name = HttpService:GenerateGUID(false)
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

if gethui then
    screenGui.Parent = gethui()
elseif syn and syn.protect_gui then
    syn.protect_gui(screenGui)
    screenGui.Parent = CoreGui
elseif get_hidden_gui then
    screenGui.Parent = get_hidden_gui()
else
    pcall(function() screenGui.Parent = CoreGui end)
    if screenGui.Parent ~= CoreGui then 
        screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui") 
    end
end

local iconCache = {}
local function getIcon(name)
    if iconCache[name] then return iconCache[name] end
    local icons = {
        menu = "lucide-menu",
        x = "lucide-x", 
        chevronDown = "lucide-chevron-down",
        chevronUp = "lucide-chevron-up",
        check = "lucide-check",
        square = "lucide-square",
        circle = "lucide-circle",
        settings = "lucide-settings",
        palette = "lucide-palette"
    }
    local iconName = icons[name] or name
    local success, assetId = pcall(function()
        return game:GetObjects("rbxassetid://10709751939")[1]
    end)
    if success then
        iconCache[name] = "rbxassetid://10709751939"
        return iconCache[name]
    end
    return ""
end

local function tween(obj, props, duration)
    TweenService:Create(obj, TweenInfo.new(duration or 0.3, Enum.EasingStyle.Quad), props):Play()
end

local function createDrag(frame)
    local dragging, dragInput, dragStart, startPos
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
